# 详解格式化快速参考

## 🎯 核心命令

### `\exstep` - 步骤标记

```latex
% 自动编号：(1), (2), (3), ...
\exstep

% 自定义标签
\exstep[法一]
\exstep[证明]
\exstep[小结]
```

## 📝 三种使用方式

### 1️⃣ 简单分段（短解析，3-5 行）

```latex
\explain{
由题意可知 $c^2 = 2a^2$。

因为焦点为 $(\pm 2, 0)$，所以 $c = 2$。

双曲线方程为 $\frac{x^2}{2} - \frac{y^2}{2} = 1$。
}
```

**效果**：
- 每段自动首行缩进 2em
- 段间距 0.4 倍行距

---

### 2️⃣ 步骤标记（中等解析，5-10 行）

```latex
\explain{
设双曲线的实轴、虚轴、焦距分别为 $2a, 2b, 2c$。
\exstep
由题知 $b = \sqrt{7}a$。
\exstep
由 $c^2 = a^2 + b^2 = 8a^2$ 得 $c = 2\sqrt{2}a$。
\exstep
因此离心率 $e = \frac{c}{a} = 2\sqrt{2}$。
}
```

**效果**：
- 【详解】 设双曲线...
- **(1)** 由题知...
- **(2)** 由 $c^2 = a^2 + b^2$...
- **(3)** 因此离心率...

---

### 3️⃣ 自定义标签（长解析，>10 行或多解法）

```latex
\explain{
\exstep[法一：导数法]
对 $f(x)$ 求导得 $f'(x) = -5\sin x + 5\sin 5x$...

计算得最大值为 $3\sqrt{3}$。

\exstep[法二：五倍角公式]
利用 $\cos 5x = 16\cos^5 x - 20\cos^3 x + 5\cos x$...

同样得到 $3\sqrt{3}$。

\exstep[小结]
两种方法验证了答案正确性。
}
```

**效果**：
- **法一：导数法** 对 $f(x)$ 求导...
- 
- 计算得...
- 
- **法二：五倍角公式** 利用...
- 
- **小结** 两种方法...

---

## 🔧 格式参数

| 参数 | 值 | 说明 |
|------|------|------|
| `\parskip` | `0.4\baselineskip` | 段间距 |
| `\parindent` | `2em` | 首行缩进 |
| `\exstep` 前间距 | `0.25\baselineskip` | 步骤前垂直间距 |

---

## ✅ 使用建议

| 解析长度 | 推荐方式 | 示例题型 |
|---------|---------|---------|
| 1-3 行 | 保持原样 | 单选题、简单填空 |
| 3-5 行 | 空行分段 | 中等难度选择题 |
| 5-10 行 | `\exstep` 自动编号 | 解答题各小问 |
| >10 行 | `\exstep[标签]` | 证明题、综合题 |

---

## 📚 完整示例

```latex
\begin{question}
（立体几何综合题）...
\explain{
\exstep[证明(1)]
在四棱锥 $P-ABCD$ 中...

因为 $AB \subset$ 平面 $ABCD$...

因此平面 $PAB \bot$ 平面 $PAD$。

\exstep[证明(2)(i)]
建立空间直角坐标系...

设球心为 $O(0,y_0,0)$...

解得 $y_0 = 1$，故点 $O$ 在平面内。

\exstep[计算(2)(ii)]
向量法计算夹角...

$$\cos\theta = \frac{\sqrt{2}}{3}$$
}
\end{question}
```

---

## ⚠️ 注意事项

1. **向后兼容**：不使用 `\exstep` 的旧解析仍然正常工作
2. **花括号平衡**：确保 `\explain{...}` 的花括号配对
3. **数学环境**：`\exstep` 只能在文本模式使用，不能在 `\(...\)` 内
4. **计数器自动重置**：每题的步骤编号自动从 (1) 开始

---

**版本**：v3.2  
**文档**：`docs/EXPLAIN_FORMATTING_GUIDE.md`
